/*!
* jQuery appendGrid v1.6.2
* https://appendgrid.apphb.com/
*
* Copyright 2016 Albert L.
* Dual licensed under the LGPL (http://www.gnu.org/licenses/lgpl.html)
* and MIT (http://www.opensource.org/licenses/mit-license.php) licenses.
*
* Depends:
* jQuery v1.11.1+
* jQuery UI v1.11.1+
*/
(function(h){var t={caption:null,captionTooltip:null,initRows:3,maxRowsAllowed:0,initData:null,columns:null,i18n:null,idPrefix:null,rowDragging:false,hideButtons:null,hideRowNumColumn:false,rowButtonsInFront:false,rowCountName:"_RowCount",buttonClasses:null,sectionClasses:null,customGridButtons:null,customRowButtons:null,customFooterButtons:null,useSubPanel:false,maintainScroll:false,maxBodyHeight:0,autoColumnWidth:true};var F={nameFormatter:null,dataLoaded:null,rowDataLoaded:null,afterRowAppended:null,afterRowInserted:null,afterRowSwapped:null,beforeRowRemove:null,afterRowRemoved:null,afterRowDragged:null,subPanelBuilder:null,subPanelGetter:null,maxNumRowsReached:null};var A={type:"text",name:null,value:null,display:null,displayCss:null,displayTooltip:null,headerSpan:1,cellCss:null,ctrlAttr:null,ctrlProp:null,ctrlCss:null,ctrlClass:null,ctrlOptions:null,uiOption:null,uiTooltip:null,resizable:false,invisible:false,emptyCriteria:null,customBuilder:null,customGetter:null,customSetter:null,onClick:null,onChange:null};var u={noColumnInfo:"Cannot initial grid without column information!",elemNotTable:"Cannot initial grid on element other than TABLE!",notInit:"`appendGrid` does not initialized",getValueMultiGrid:"Cannot get values on multiple grid",notSupportMethod:"Method is not supported by `appendGrid`: "};var y={append:"Append Row",removeLast:"Remove Last Row",insert:"Insert Row Above",remove:"Remove Current Row",moveUp:"Move Up",moveDown:"Move Down",rowDrag:"Sort Row",rowEmpty:"This Grid Is Empty"};var m={append:null,removeLast:null,insert:null,remove:null,moveUp:null,moveDown:null,rowDrag:null};var o={caption:null,header:null,body:null,subPanel:null,footer:null};var g={append:false,removeLast:false,insert:false,remove:false,moveUp:false,moveDown:false};var l={init:function(K){var Z=this;if(Z.length>0){if(!h.isArray(K.columns)||K.columns.length==0){alert(u.noColumnInfo);return Z}var T=Z[0],N,L,Q,X,Y,V,H;if(p(T.tagName)||T.tagName!="TABLE"){alert(u.elemNotTable);return Z}var W=h.extend({},t,F,K);h.extend(W,{_uniqueIndex:0,_rowOrder:[],_isDataLoaded:false,_visibleCount:0,_finalColSpan:0,_hideLastColumn:false,_wrapperId:null,_calculateWidth:true});if(h.isPlainObject(K.i18n)){W._i18n=h.extend({},y,K.i18n)}else{W._i18n=h.extend({},y)}if(h.isPlainObject(K.buttonClasses)){W._buttonClasses=h.extend({},m,K.buttonClasses)}else{W._buttonClasses=h.extend({},m)}if(h.isPlainObject(K.sectionClasses)){W._sectionClasses=h.extend({},o,K.sectionClasses)}else{W._sectionClasses=h.extend({},o)}if(h.isPlainObject(K.hideButtons)){W.hideButtons=h.extend({},g,K.hideButtons)}else{W.hideButtons=h.extend({},g)}if(p(W.idPrefix)){if(p(T.id)||T.id==""){W.idPrefix="ag"+new Date().getTime()}else{W.idPrefix=T.id}}if(!h.isPlainObject(W.customGridButtons)){W.customGridButtons={}}if(W.useSubPanel&&W.rowDragging){W.rowDragging=false}L=document.createElement("thead");L.className="ui-widget-header";Q=document.createElement("tbody");Q.className="ui-widget-content";X=document.createElement("tfoot");X.className="ui-widget-header";Y=document.createElement("colgroup");W._wrapperId=W.idPrefix+"-wrapper";N=document.createElement("div");h(N).attr("id",W._wrapperId).addClass("appendGrid").insertAfter(T);h(T).empty().addClass("ui-widget").appendTo(N);if(W.maxBodyHeight>0){h("<table></table>").addClass("ui-widget head").append(L).prependTo(N);h(T).addClass("body").wrap(h("<div></div>").addClass("scroller").css("max-height",W.maxBodyHeight)).append(Y,Q);h("<table></table>").addClass("ui-widget foot").append(X).appendTo(N)}else{h(T).addClass("head body foot").append(Y,L,Q,X)}var I,S;L.appendChild(V=document.createElement("tr"));if(W._sectionClasses.header){V.className="columnHead "+W._sectionClasses.header}else{V.className="columnHead"}if(!W.hideRowNumColumn){V.appendChild(I=document.createElement("td"));I.className="ui-widget-header first";Y.appendChild(document.createElement("col"))}var M=0;for(var O=0;O<W.columns.length;O++){var R=h.extend({},A,W.columns[O]);W.columns[O]=R;if(W.columns[O].type!="hidden"){if(!W.columns[O].invisible){W._visibleCount++}if(M==0){var J="ui-widget-header";if(W.columns[O].invisible){J+=" invisible"}if(W.columns[O].resizable){J+=" resizable"}V.appendChild(H=document.createElement("td"));H.id=W.idPrefix+"_"+W.columns[O].name+"_td_head";H.className=J;if(W.columns[O].displayCss){h(H).css(W.columns[O].displayCss)}if(W.columns[O].headerSpan>1){h(H).attr("colSpan",W.columns[O].headerSpan);M=W.columns[O].headerSpan-1}if(h.isPlainObject(W.columns[O].displayTooltip)){h(H).tooltip(W.columns[O].displayTooltip)}else{if(!p(W.columns[O].displayTooltip)){h(H).attr("title",W.columns[O].displayTooltip).tooltip()}}if(h.isFunction(W.columns[O].display)){W.columns[O].display(H)}else{if(!p(W.columns[O].display)){h(H).text(W.columns[O].display)}}Y.appendChild(document.createElement("col"))}else{M--}}}if(!p(jQuery.ui.resizable)){h("td.resizable",L).resizable({handles:"e"})}if(W.hideButtons.insert&&W.hideButtons.remove&&W.hideButtons.moveUp&&W.hideButtons.moveDown&&(!h.isArray(W.customRowButtons)||W.customRowButtons.length==0)){W._hideLastColumn=true}W._finalColSpan=W._visibleCount;if(!W.hideRowNumColumn){W._finalColSpan++}if(!W._hideLastColumn){W._finalColSpan++}if(!W._hideLastColumn){if(W.rowButtonsInFront){if(W.hideRowNumColumn){V.insertBefore(S=document.createElement("td"),V.firstChild)}else{V.insertBefore(S=document.createElement("td"),V.childnodes[1])}}else{V.appendChild(S=document.createElement("td"))}S.className="ui-widget-header last";Y.appendChild(document.createElement("col"))}if(W.caption){L.insertBefore(V=document.createElement("tr"),L.firstChild);if(W._sectionClasses.caption){V.className=W._sectionClasses.caption}V.appendChild(H=document.createElement("td"));H.id=W.idPrefix+"_caption_td";H.className="ui-state-active caption";H.colSpan=W._finalColSpan;if(h.isPlainObject(W.captionTooltip)){h(H).tooltip(W.captionTooltip)}else{if(!p(W.captionTooltip)){h(H).attr("title",W.captionTooltip).tooltip()}}if(h.isFunction(W.caption)){W.caption(H)}else{h(H).text(W.caption)}}X.appendChild(V=document.createElement("tr"));if(W._sectionClasses.footer){V.className=W._sectionClasses.footer}V.appendChild(H=document.createElement("td"));H.id=W.idPrefix+"_footer_td";H.colSpan=W._finalColSpan;h("<input/>").attr({type:"hidden",id:W.idPrefix+"_rowOrder",name:W.idPrefix+"_rowOrder"}).appendTo(H);if(W.hideButtons.append&&W.hideButtons.removeLast&&(!h.isArray(W.customFooterButtons)||W.customFooterButtons.length==0)){V.style.display="none"}else{if(!W.hideButtons.append){var G=n(W.customGridButtons.append,"ui-icon-plusthick").attr({title:W._i18n.append}).addClass("append").click(function(aa){d(T,1,null,null);if(aa&&aa.preventDefault){aa.preventDefault()}return false}).appendTo(H);if(!p(W._buttonClasses.append)){G.addClass(W._buttonClasses.append)}}if(!W.hideButtons.removeLast){var G=n(W.customGridButtons.removeLast,"ui-icon-closethick").attr({title:W._i18n.removeLast}).addClass("removeLast").click(function(aa){k(T,null,this.value,false);if(aa&&aa.preventDefault){aa.preventDefault()}return false}).appendTo(H);if(!p(W._buttonClasses.removeLast)){G.addClass(W._buttonClasses.removeLast)}}if(W.customFooterButtons&&W.customFooterButtons.length){for(var P=W.customFooterButtons.length-1;P>=0;P--){var U=W.customFooterButtons[P];if(U&&U.uiButton&&U.click&&U.atTheFront){h(H).prepend(s(T,U))}}for(var P=0;P<W.customFooterButtons.length;P++){var U=W.customFooterButtons[P];if(U&&U.uiButton&&U.click&&!U.atTheFront){h(H).append(s(T,U))}}}}if(W.rowDragging){h(Q).sortable({axis:"y",containment:T,handle:".rowDrag",helper:function(ac,ab){var ad=ab.children();var aa=ab.clone();aa.children().each(function(af){h(this).width(ad.eq(af).width());var ae=h("select",this);if(ae.length>0){for(var ah=0;ah<ae.length;ah++){var ag=ad.eq(af).find("select");if(ag.length>ah){ae[ah].value=ag[ah].value}}}});return aa},update:function(ac,ad){var aa=ad.item[0].id.substring(ad.item[0].id.lastIndexOf("_")+1);var ab=ad.item[0].rowIndex-h("tr",L).length;r(T,ad.originalPosition.top>ad.position.top,aa,ab)}})}h(T).data("appendGrid",W);if(h.isArray(K.initData)){a(T,K.initData,true)}else{h(T).appendGrid("appendRow",W.initRows)}if(W._rowOrder.length==0){f(N,W,true)}if(W.maxBodyHeight>0){if(W.autoColumnWidth){v(N)}else{h("table.foot",N).width(h(T).width())}}}return Z},isReady:function(){var G=e(this,true);if(G){return true}return false},isDataLoaded:function(){var G=e(this);if(G){return G._isDataLoaded}return false},load:function(G){var H=e(this),I=this;if(H){if(G!=null&&G.length>0){a(I[0],G,false)}else{C(I[0])}}return I},appendRow:function(G){return this.appendGrid("insertRow",G)},insertRow:function(J,L,H){var K=e(this);if(K){if((h.isArray(J)&&J.length>0)||(h.isNumeric(J)&&J>0)){var G=this[0];insertResult=d(G,J,L,H);if(h.isNumeric(L)||h.isNumeric(H)){x(G,insertResult.rowIndex);var I=K._rowOrder[insertResult.addedRows[0]];h("#"+K.idPrefix+"_Insert_"+I,G).focus()}}}return this},removeRow:function(I,G){var H=e(this);if(H&&H._rowOrder.length>0){k(this[0],I,G,true)}return this},emptyGrid:function(){var G=e(this);if(G){C(this[0])}return target},moveUpRow:function(N,M){var H=e(this),L=this;if(H){var K=L[0],P,G,J,I,O=null;var Q=K.getElementsByTagName("tbody")[0];if(h.isNumeric(N)&&N>0&&N<H._rowOrder.length){O=N;M=H._rowOrder[N]}else{if(h.isNumeric(M)){O=i(M,H)}}if(O!=null&&O>0){P=document.getElementById(H.idPrefix+"_Row_"+M,K);G=document.getElementById(H.idPrefix+"_Row_"+H._rowOrder[O-1],K);if(H.useSubPanel){J=document.getElementById(H.idPrefix+"_SubRow_"+M,K)}Q.removeChild(P);if(H.useSubPanel){Q.removeChild(J)}Q.insertBefore(P,G);if(H.useSubPanel){Q.insertBefore(J,G)}H._rowOrder[O]=H._rowOrder[O-1];H._rowOrder[O-1]=M;I=h("td.first",G).html();h("td.first",G).html(h("td.first",P).html());h("td.first",P).html(I);b(K,H);h("td.last button.moveUp",P).removeClass("ui-state-hover").blur();h("td.last button.moveUp",G).focus();if(H.afterRowSwapped){H.afterRowSwapped(K,O,O-1)}}}return L},moveDownRow:function(N,M){var I=e(this),L=this;if(I){var K=L[0],P,H,G,J,O=null;var Q=K.getElementsByTagName("tbody")[0];if(h.isNumeric(N)&&N>=0&&N<I._rowOrder.length-1){O=N;M=I._rowOrder[N]}else{if(h.isNumeric(M)){O=i(M,I)}}if(O!=null&&O!=I._rowOrder.length-1){P=document.getElementById(I.idPrefix+"_Row_"+M,K);H=document.getElementById(I.idPrefix+"_Row_"+I._rowOrder[O+1],K);if(I.useSubPanel){G=document.getElementById(I.idPrefix+"_SubRow_"+I._rowOrder[O+1],K)}Q.removeChild(H);Q.insertBefore(H,P);if(I.useSubPanel){Q.insertBefore(G,P)}I._rowOrder[O]=I._rowOrder[O+1];I._rowOrder[O+1]=M;J=h("td.first",H).html();h("td.first",H).html(h("td.first",P).html());h("td.first",P).html(J);b(K,I);h("td.last button.moveDown",P).removeClass("ui-state-hover").blur();h("td.last button.moveDown",H).focus();if(I.afterRowSwapped){I.afterRowSwapped(K,O,O+1)}}}return L},showColumn:function(J){var K=e(this);if(K&&J){var I=-1,H=this[0];for(var L=0;L<K.columns.length;L++){if(K.columns[L].name==J){I=L;break}}if(I!=-1&&K.columns[I].invisible){K._visibleCount++;K._finalColSpan++;h("#"+K.idPrefix+"_caption_td").attr("colSpan",K._finalColSpan);h("#"+K.idPrefix+"_footer_td").attr("colSpan",K._finalColSpan);h("#"+K.idPrefix+"_"+J+"_td_head").removeClass("invisible");for(var L=0;L<K._rowOrder.length;L++){var G=K._rowOrder[L];h("#"+K.idPrefix+"_"+J+"_td_"+G).removeClass("invisible");if(K.useSubPanel){h("#"+K.idPrefix+"_SubRow_"+G).attr("colSpan",K._visibleCount+(K._hideLastColumn?0:1))}}K.columns[I].invisible=false;b(H,K)}}return this},hideColumn:function(J){var K=e(this);if(K&&J){var I=-1,H=this[0];for(var L=0;L<K.columns.length;L++){if(K.columns[L].name==J){I=L;break}}if(I!=-1&&!K.columns[I].invisible){K._visibleCount--;K._finalColSpan--;h("#"+K.idPrefix+"_caption_td").attr("colSpan",K._finalColSpan);h("#"+K.idPrefix+"_footer_td").attr("colSpan",K._finalColSpan);h("#"+K.idPrefix+"_"+J+"_td_head").addClass("invisible");for(var L=0;L<K._rowOrder.length;L++){var G=K._rowOrder[L];h("#"+K.idPrefix+"_"+J+"_td_"+G).addClass("invisible");if(K.useSubPanel){h("#"+K.idPrefix+"_SubRow_"+G).attr("colSpan",K._visibleCount+(K._hideLastColumn?0:1))}}K.columns[I].invisible=true;b(H,K)}}return this},isColumnInvisible:function(G){var H=e(this);if(H&&G){for(var I=0;I<H.columns.length;I++){if(H.columns[I].name==G){return H.columns[I].invisible}}}return null},getRowCount:function(){var G=e(this);if(G){return G._rowOrder.length}return null},getUniqueIndex:function(H){var G=e(this);if(G&&h.isNumeric(H)&&H<G._rowOrder.length){return G._rowOrder[H]}return null},getRowIndex:function(G){var H=e(this);if(H&&h.isNumeric(G)){for(var I=0;I<H._rowOrder.length;I++){if(H._rowOrder[I]==G){return I}}}return null},getRowValue:function(K,H,J){var I=e(this),G=null;if(I){if(h.isNumeric(K)&&K>=0&&K<I._rowOrder.length){H=I._rowOrder[K]}if(!p(H)){G=j(I,H,J)}}return G},getAllValue:function(I){var H=e(this),G=null;if(H){G=I?{}:[];for(var J=0;J<H._rowOrder.length;J++){if(I){rowValue=j(H,H._rowOrder[J],J);h.extend(G,rowValue)}else{rowValue=j(H,H._rowOrder[J]);G.push(rowValue)}}if(I){G[H.rowCountName]=H._rowOrder.length}}return G},getCtrlValue:function(G,J){var H=e(this);if(H&&J>=0&&J<H._rowOrder.length){for(var I=0;I<H.columns.length;I++){if(H.columns[I].name===G){return c(H,I,H._rowOrder[J])}}}return null},setCtrlValue:function(G,K,I){var H=e(this);if(H&&K>=0&&K<H._rowOrder.length){for(var J=0;J<H.columns.length;J++){if(H.columns[J].name==G){q(H,J,H._rowOrder[K],I);break}}}return this},getCellCtrl:function(H,K){var I=e(this);if(I&&K>=0&&K<I._rowOrder.length){var G=I._rowOrder[K];for(var J=0;J<I.columns.length;J++){if(I.columns[J].name===H){return z(I.columns[J].type,I.idPrefix,H,G)}}}return null},getCellCtrlByUniqueIndex:function(H,G){var I=e(this);if(I){for(var J=0;J<I.columns.length;J++){if(I.columns[J].name===H){return z(I.columns[J].type,I.idPrefix,H,G)}}}return null},getRowOrder:function(){var G=e(this);if(G){return G._rowOrder.slice()}return null},getColumns:function(){var G=e(this);if(G){return G.columns.slice()}return null},isRowEmpty:function(H){var G=e(this);if(G){return w(G,H)}return null},removeEmptyRows:function(){var H=e(this);if(H){var G=this[0];for(var I=H._rowOrder.length;I>=0;I--){if(w(H,I)){k(G,null,H._rowOrder[I],true)}}return this}return null}};function e(H,G){var I=null;if(H.length==1){I=H.data("appendGrid");if(!I&&!G){alert(u.notInit)}}else{if(!G){alert(u.getValueMultiGrid)}}return I}function d(aa,I,G,ac){var an=h(aa).data("appendGrid");var ap=[],H=null,O,ak,N=[];var K=aa.getElementsByTagName("thead")[0];var Q=aa.getElementsByTagName("tbody")[0];var W,R=null,V,Y=false,S=false;var X=0,M=0;if(an.maxBodyHeight>0){K=h("#"+an._wrapperId+" table thead")[0]}var T=I,L=false;if(h.isArray(I)){T=I.length;L=true}if(h.isNumeric(ac)){for(var ae=0;ae<an._rowOrder.length;ae++){if(an._rowOrder[ae]==ac){G=ae;if(ae!=0){H=ae-1}break}}}else{if(h.isNumeric(G)){if(G>=an._rowOrder.length){G=null}else{H=G-1}}else{if(an._rowOrder.length!=0){G=null;H=an._rowOrder.length-1}}}if(an.maintainScroll&&!h.isNumeric(G)){X=h(aa).height();M=h(aa).scrollParent().scrollTop()}if(an._rowOrder.length==0){h("tr.empty",aa).remove();S=true}for(var ae=0;ae<T;ae++){if(0<an.maxRowsAllowed&&an._rowOrder.length>=an.maxRowsAllowed){Y=true;break}an._uniqueIndex++;O=an._uniqueIndex;N.length=0;if(h.isNumeric(G)){an._rowOrder.splice(G,0,O);if(an.useSubPanel){Q.insertBefore(R=document.createElement("tr"),Q.childNodes[G*2]);Q.insertBefore(W=document.createElement("tr"),Q.childNodes[G*2])}else{Q.insertBefore(W=document.createElement("tr"),Q.childNodes[G])}ap.push(G)}else{an._rowOrder.push(O);Q.appendChild(W=document.createElement("tr"));if(an.useSubPanel){Q.appendChild(R=document.createElement("tr"))}ap.push(an._rowOrder.length-1)}W.id=an.idPrefix+"_Row_"+O;if(an._sectionClasses.body){W.className=an._sectionClasses.body}h(W).data("appendGrid",O);if(R!=null){R.id=an.idPrefix+"_SubRow_"+O;h(R).data("appendGrid",O);if(an._sectionClasses.subPanel){R.className=an._sectionClasses.subPanel}}if(!an.hideRowNumColumn){W.appendChild(V=document.createElement("td"));h(V).addClass("ui-widget-content first").text(an._rowOrder.length);if(an.useSubPanel){V.rowSpan=2}}for(var af=0;af<an.columns.length;af++){if(an.columns[af].type=="hidden"){N.push(af);continue}var al="ui-widget-content";if(an.columns[af].invisible){al+=" invisible"}W.appendChild(V=document.createElement("td"));V.id=an.idPrefix+"_"+an.columns[af].name+"_td_"+O;V.className=al;if(an.columns[af].cellCss!=null){h(V).css(an.columns[af].cellCss)}var ai=an.idPrefix+"_"+an.columns[af].name+"_"+O,U;if(h.isFunction(an.nameFormatter)){U=an.nameFormatter(an.idPrefix,an.columns[af].name,O)}else{U=ai}ak=null;if(an.columns[af].type=="custom"){if(h.isFunction(an.columns[af].customBuilder)){ak=an.columns[af].customBuilder(V,an.idPrefix,an.columns[af].name,O)}}else{if(an.columns[af].type=="select"||an.columns[af].type=="ui-selectmenu"){ak=document.createElement("select");ak.id=ai;ak.name=U;if(h.isArray(an.columns[af].ctrlOptions)){if(an.columns[af].ctrlOptions.length>0){if(h.isPlainObject(an.columns[af].ctrlOptions[0])){var ab=null,J=null;for(var ah=0;ah<an.columns[af].ctrlOptions.length;ah++){if(!p(an.columns[af].ctrlOptions[ah].group)){if(ab!=an.columns[af].ctrlOptions[ah].group){ab=an.columns[af].ctrlOptions[ah].group;J=document.createElement("optgroup");J.label=ab;ak.appendChild(J)}}else{J=null}var ad=h("<option/>").val(an.columns[af].ctrlOptions[ah].value).text(an.columns[af].ctrlOptions[ah].label);if(!p(an.columns[af].ctrlOptions[ah].title)){ad.attr("title",an.columns[af].ctrlOptions[ah].title)}if(null==J){ad.appendTo(ak)}else{ad.appendTo(J)}}}else{for(var ah=0;ah<an.columns[af].ctrlOptions.length;ah++){ak.options[ak.options.length]=new Option(an.columns[af].ctrlOptions[ah],an.columns[af].ctrlOptions[ah])}}}}else{if(h.isPlainObject(an.columns[af].ctrlOptions)){for(var ah in an.columns[af].ctrlOptions){ak.options[ak.options.length]=new Option(an.columns[af].ctrlOptions[ah],ah)}}else{if(typeof(an.columns[af].ctrlOptions)=="string"){var ao=an.columns[af].ctrlOptions.split(";");for(var ah=0;ah<ao.length;ah++){var aq=ao[ah].indexOf(":");if(-1==aq){ak.options[ak.options.length]=new Option(ao[ah],ao[ah])}else{ak.options[ak.options.length]=new Option(ao[ah].substring(aq+1,ao[ah].length),ao[ah].substring(0,aq))}}}else{if(h.isFunction(an.columns[af].ctrlOptions)){an.columns[af].ctrlOptions(ak)}}}}V.appendChild(ak);if(an.columns[af].type=="ui-selectmenu"){h(ak).selectmenu(an.columns[af].uiOption)}}else{if(an.columns[af].type=="checkbox"){ak=document.createElement("input");ak.type="checkbox";ak.id=ai;ak.name=U;ak.value=1;V.appendChild(ak);V.style.textAlign="center"}else{if(an.columns[af].type=="textarea"){ak=document.createElement("textarea");ak.id=ai;ak.name=U;V.appendChild(ak)}else{if(-1!=an.columns[af].type.search(/^(color|date|datetime|datetime\-local|email|month|number|range|search|tel|time|url|week)$/)){ak=document.createElement("input");try{ak.type=an.columns[af].type}catch(am){}ak.id=ai;ak.name=U;V.appendChild(ak)}else{ak=document.createElement("input");ak.type="text";ak.id=ai;ak.name=U;V.appendChild(ak);if(an.columns[af].type=="ui-datepicker"){h(ak).datepicker(an.columns[af].uiOption)}else{if(an.columns[af].type=="ui-spinner"){h(ak).spinner(an.columns[af].uiOption)}else{if(an.columns[af].type=="ui-autocomplete"){h(ak).autocomplete(an.columns[af].uiOption)}}}}}}}}if(an.columns[af].type!="custom"){if(an.columns[af].ctrlAttr!=null){h(ak).attr(an.columns[af].ctrlAttr)}if(an.columns[af].ctrlProp!=null){h(ak).prop(an.columns[af].ctrlProp)}if(an.columns[af].ctrlCss!=null){h(ak).css(an.columns[af].ctrlCss)}if(an.columns[af].ctrlClass!=null){h(ak).addClass(an.columns[af].ctrlClass)}if(an.columns[af].uiTooltip){h(ak).tooltip(an.columns[af].uiTooltip)}if(h.isFunction(an.columns[af].onClick)){h(ak).click({caller:aa,callback:an.columns[af].onClick,uniqueIndex:O},function(ar){ar.data.callback(ar,h(ar.data.caller).appendGrid("getRowIndex",ar.data.uniqueIndex))})}if(h.isFunction(an.columns[af].onChange)){h(ak).change({caller:aa,callback:an.columns[af].onChange,uniqueIndex:O},function(ar){ar.data.callback(ar,h(ar.data.caller).appendGrid("getRowIndex",ar.data.uniqueIndex))})}}if(L){q(an,af,O,I[ae][an.columns[af].name])}else{if(!p(an.columns[af].value)){q(an,af,O,an.columns[af].value)}}}if(!an._hideLastColumn||an.columns.length>an._visibleCount){if(!an.rowButtonsInFront){W.appendChild(V=document.createElement("td"))}else{if(!an.hideRowNumColumn){W.insertBefore(V=document.createElement("td"),W.childNodes[1])}else{W.insertBefore(V=document.createElement("td"),W.firstChild)}}V.className="ui-widget-content last";if(an._hideLastColumn){V.style.display="none"}if(!an.hideButtons.insert){var P=n(an.customGridButtons.insert,"ui-icon-arrowreturnthick-1-w").attr({id:an.idPrefix+"_Insert_"+O,title:an._i18n.insert,tabindex:-1}).addClass("insert").data("appendGrid",{uniqueIndex:O}).click(function(at){var ar=h(this).data("appendGrid").uniqueIndex;h(aa).appendGrid("insertRow",1,null,ar);if(at&&at.preventDefault){at.preventDefault(an._buttonClasses.insert)}return false}).appendTo(V);if(!p(an._buttonClasses.insert)){P.addClass(an._buttonClasses.insert)}}if(!an.hideButtons.remove){var P=n(an.customGridButtons.remove,"ui-icon-trash").attr({id:an.idPrefix+"_Delete_"+O,title:an._i18n.remove,tabindex:-1}).addClass("remove").data("appendGrid",{uniqueIndex:O}).click(function(at){var ar=h(this).data("appendGrid").uniqueIndex;k(aa,null,ar,false);if(at&&at.preventDefault){at.preventDefault()}return false}).appendTo(V);if(!p(an._buttonClasses.remove)){P.addClass(an._buttonClasses.remove)}}if(!an.hideButtons.moveUp){var P=n(an.customGridButtons.moveUp,"ui-icon-arrowthick-1-n").attr({id:an.idPrefix+"_MoveUp_"+O,title:an._i18n.moveUp,tabindex:-1}).addClass("moveUp").data("appendGrid",{uniqueIndex:O}).click(function(at){var ar=h(this).data("appendGrid").uniqueIndex;h(aa).appendGrid("moveUpRow",null,ar);if(at&&at.preventDefault){at.preventDefault()}return false}).appendTo(V);if(!p(an._buttonClasses.moveUp)){P.addClass(an._buttonClasses.moveUp)}}if(!an.hideButtons.moveDown){var P=n(an.customGridButtons.moveDown,"ui-icon-arrowthick-1-s").attr({id:an.idPrefix+"_MoveDown_"+O,title:an._i18n.moveDown,tabindex:-1}).addClass("moveDown").data("appendGrid",{uniqueIndex:O}).click(function(at){var ar=h(this).data("appendGrid").uniqueIndex;h(aa).appendGrid("moveDownRow",null,ar);if(at&&at.preventDefault){at.preventDefault()}return false}).appendTo(V);if(!p(an._buttonClasses.moveDown)){P.addClass(an._buttonClasses.moveDown)}}if(an.rowDragging){var P=h("<div/>").addClass("rowDrag ui-state-default ui-corner-all").attr("title",an._i18n.rowDrag).append(h("<div/>").addClass("ui-icon ui-icon-carat-2-n-s").append(h("<span/>").addClass("ui-button-text").text("Drag"))).appendTo(V);if(!p(an._buttonClasses.rowDrag)){P.addClass(an._buttonClasses.rowDrag)}}for(var af=0;af<N.length;af++){ak=document.createElement("input");ak.id=an.idPrefix+"_"+an.columns[N[af]].name+"_"+O;if(h.isFunction(an.nameFormatter)){ak.name=an.nameFormatter(an.idPrefix,an.columns[af].name,O)}else{ak.name=ak.id}ak.type="hidden";if(L){ak.value=I[ae][an.columns[N[af]].name]}else{if(!p(an.columns[N[af]].value)){ak.value=an.columns[N[af]].value}}V.appendChild(ak)}if(an.customRowButtons&&an.customRowButtons.length){for(var af=an.customRowButtons.length-1;af>=0;af--){var ag=an.customRowButtons[af];if(ag&&ag.uiButton&&ag.click&&ag.atTheFront){h(V).prepend(B(aa,ag,O))}}for(var af=0;af<an.customRowButtons.length;af++){var ag=an.customRowButtons[af];if(ag&&ag.uiButton&&ag.click&&!ag.atTheFront){h(V).append(B(aa,ag,O))}}}}if(an.useSubPanel){R.appendChild(V=document.createElement("td"));V.className="ui-widget-content";V.colSpan=an._visibleCount+(an._hideLastColumn?0:1);if(h.isFunction(an.subPanelBuilder)){an.subPanelBuilder(V,O)}}}if(0<an.maxBodyHeight&&an._calculateWidth&&!S){var aj=h("#"+an._wrapperId+">div.scroller")[0];if(aj.scrollHeight>aj.offsetHeight){S=true;an._calculateWidth=false}}b(aa,an);if(S&&an.autoColumnWidth&&an.maxBodyHeight>0){v(document.getElementById(an._wrapperId))}if(h.isNumeric(G)){if(h.isFunction(an.afterRowInserted)){an.afterRowInserted(aa,H,ap)}}else{if(h.isFunction(an.afterRowAppended)){an.afterRowAppended(aa,H,ap)}}if(Y&&h.isFunction(an.maxNumRowsReached)){an.maxNumRowsReached()}if(an.maintainScroll&&!h.isNumeric(G)){var Z=h(aa).height();h(aa).scrollParent().scrollTop(M+Z-X)}return{addedRows:ap,parentIndex:H,rowIndex:G}}function s(G,I){var H=h("<button/>").attr({type:"button",tabindex:-1}).button(I.uiButton).click({tbWhole:G},I.click);if(I.btnClass){H.addClass(I.btnClass)}if(I.btnCss){H.css(I.btnCss)}if(I.btnAttr){H.attr(I.btnAttr)}return H}function B(H,J,G){var I=h("<button/>").val(G).attr({type:"button",tabindex:-1}).button(J.uiButton).click({tbWhole:H,uniqueIndex:G},function(K){var L=h(K.data.tbWhole).appendGrid("getRowValue",null,K.data.uniqueIndex);J.click(K,K.data.uniqueIndex,L)});if(J.btnClass){I.addClass(J.btnClass)}if(J.btnCss){I.css(J.btnCss)}if(J.btnAttr){I.attr(J.btnAttr)}return I}function k(J,M,K,H){var I=h(J).data("appendGrid");var P=J.getElementsByTagName("tbody")[0];if(h.isNumeric(K)){for(var L=0;L<I._rowOrder.length;L++){if(I._rowOrder[L]==K){M=L;break}}}if(h.isNumeric(M)){if(H||typeof(I.beforeRowRemove)!="function"||I.beforeRowRemove(J,M)){I._rowOrder.splice(M,1);if(I.useSubPanel){P.removeChild(P.childNodes[M*2]);P.removeChild(P.childNodes[M*2])}else{P.removeChild(P.childNodes[M])}b(J,I);x(J,M);if(h.isFunction(I.afterRowRemoved)){I.afterRowRemoved(J,M)}}}else{var O=0,N=0;if(I.maintainScroll){O=h(J).height();N=h(J).scrollParent().scrollTop()}if(H||!h.isFunction(I.beforeRowRemove)||I.beforeRowRemove(J,I._rowOrder.length-1)){K=I._rowOrder.pop();P.removeChild(P.lastChild);if(I.useSubPanel){P.removeChild(P.lastChild)}b(J,I);if(h.isFunction(I.afterRowRemoved)){I.afterRowRemoved(J,null)}}if(I.maintainScroll){var G=h(J).height();h(J).scrollParent().scrollTop(N+G-O)}}if(I._rowOrder.length==0){f(document.getElementById(I._wrapperId),I)}}function f(G,I,H){var J=h("<td></td>").text(I._i18n.rowEmpty).attr("colspan",I._finalColSpan);h("table.body tbody",G).append(h("<tr></tr>").addClass("empty").append(J));if(!H&&I.maxBodyHeight>0){if(I.autoColumnWidth){v(G)}else{J.width(h("table.head",G).width()-4)}}}function C(G){var H=h(G).data("appendGrid");h("tbody",G).empty();H._rowOrder.length=0;H._uniqueIndex=0;b(G,H);f(document.getElementById(H._wrapperId),H)}function x(G,J){var H=h(G).data("appendGrid");if(!H.hideRowNumColumn){for(var I=J;I<H._rowOrder.length;I++){h("#"+H.idPrefix+"_Row_"+H._rowOrder[I]+" td.first",G).text(I+1)}}}function a(M,I,L){var Q,K,H,N,P;var J=h(M).data("appendGrid");if(J){Q=M.getElementsByTagName("tbody")[0];h(Q).empty();J._rowOrder.length=0;J._uniqueIndex=0;if(I!=null&&I.length){P=d(M,I.length,null,null);for(var G=0;G<P.addedRows.length;G++){for(var O=0;O<J.columns.length;O++){q(J,O,J._rowOrder[G],I[G][J.columns[O].name])}if(h.isFunction(J.rowDataLoaded)){J.rowDataLoaded(M,I[G],G,J._rowOrder[G])}}}J._isDataLoaded=true;if(L){J.initData=null}h(M).data("appendGrid",J);if(h.isFunction(J.dataLoaded)){J.dataLoaded(M,I)}}}function i(G,H){for(var I=0;I<H._rowOrder.length;I++){if(H._rowOrder[I]==G){return I}}return null}function p(G){return typeof(G)=="undefined"||G==null}function E(H,G){if(!p(H)&&h.isPlainObject(H)&&!p(H[G])){return H[G]}return null}function b(G,H){h(G).data("appendGrid",H);h("#"+H.idPrefix+"_rowOrder",G).val(H._rowOrder.join())}function D(H,G){var J=null;for(var I=0;I<H._rowOrder.length;I++){if(H._rowOrder[I]==G){return I}}return J}function j(G,H,I){var P={},M=null,L=(p(I)?"":"_"+I);for(var J=0;J<G.columns.length;J++){M=G.columns[J].name+L;P[M]=c(G,J,H)}if(G.useSubPanel&&h.isFunction(G.subPanelGetter)){var O=G.subPanelGetter(H);if(h.isPlainObject(O)){if(L==""){h.extend(P,O)}else{var N={};for(var K in O){N[K+L]=O[K]}h.extend(P,N)}}}return P}function c(K,I,G){var L=null,J=K.columns[I].type,H=K.columns[I].name;if(J=="checkbox"){L=z(J,K.idPrefix,H,G);if(L==null){return null}else{return L.checked?1:0}}else{if(J=="custom"){if(h.isFunction(K.columns[I].customGetter)){return K.columns[I].customGetter(K.idPrefix,H,G)}else{return null}}else{L=z(J,K.idPrefix,H,G);if(L==null){return null}else{return L.value}}}}function z(I,J,H,G){return document.getElementById(J+"_"+H+"_"+G)}function q(K,I,G,L){var J=K.columns[I].type;var H=K.columns[I].name;if(J=="checkbox"){z(J,K.idPrefix,H,G).checked=(L!=null&&L!=0)}else{if(J=="custom"){if(h.isFunction(K.columns[I].customSetter)){K.columns[I].customSetter(K.idPrefix,H,G,L)}}else{if(J=="ui-selectmenu"){var M=z(J,K.idPrefix,H,G);M.value=(L==null?"":L);h(M).selectmenu("refresh")}else{z(J,K.idPrefix,H,G).value=(L==null?"":L)}}}}function r(H,M,G,I){var J=h(H).data("appendGrid");var L=-1;for(var K=0;K<J._rowOrder.length;K++){if(J._rowOrder[K]==G){if(M){L=I;J._rowOrder.splice(K,1);J._rowOrder.splice(I,0,G)}else{L=K;J._rowOrder.splice(I+1,0,G);J._rowOrder.splice(K,1)}break}}x(H,L);b(H,J);if(h.isFunction(J.afterRowDragged)){J.afterRowDragged(H,I,G)}}function n(I,G){var H=null;if(I){if(h.isFunction(I)){H=h(I())}else{if(I.nodeType){H=h(I).clone()}else{if(I.icons){H=h("<button/>").attr({type:"button"}).button(I)}}}}if(!H){H=h("<button/>").attr({type:"button"}).button({icons:{primary:G},text:false})}return H}function w(K,M){for(var L=0;L<K.columns.length;L++){var H=K._rowOrder[M];var J=c(K,L,H);if(h.isFunction(K.columns[L].emptyCriteria)){if(!K.columns[L].emptyCriteria(J)){return false}}else{var G=null;if(!p(K.columns[L].emptyCriteria)){G=K.columns[L].emptyCriteria}else{if(K.columns[L].type=="checkbox"){G=0}else{if(K.columns[L].type=="select"||K.columns[L].type=="ui-selectmenu"){var I=z(K.columns[L].type,K.idPrefix,K.columns[L].name,H).options;if(I.length>0){G=I[0].value}else{G=""}}else{G=""}}}if(J!=G){return false}}}return true}function v(L){var Q=h("table.body",L);var G=h("div.scroller",L);var K=Q.data("appendGrid");var J=h("table.head tr.columnHead",L)[0];var H=h("table.body colgroup",L)[0];if(K._rowOrder.length>0){h("td",J).width("auto");h("col",H).width("auto");Q.width("auto");G.width("auto");var I=h("tbody tr",Q)[0];if(J.childNodes.length==I.childNodes.length){var P=-2;if(h.fn.modal){P=1}for(var N=0;N<I.childNodes.length;N++){var M=J.childNodes[N].clientWidth+1;var O=I.childNodes[N].clientWidth+P;if(O>M){J.childNodes[N].style.width=O+"px"}else{H.childNodes[N].style.width=M+"px"}}}}else{h("table.body,table.foot",L).width(h("table.head").width())}h("table.foot",L).width(Q.width());G.width(Q.width()+G[0].offsetWidth-G[0].clientWidth+1)}h.fn.appendGrid=function(G){if(l[G]){return l[G].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof(G)==="object"||!G){return l.init.apply(this,arguments)}else{alert(u.notSupportMethod+G)}}}})(jQuery);